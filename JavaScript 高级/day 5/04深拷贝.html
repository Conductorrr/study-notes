<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>title</title>
  <script src="jquery-1.12.4.js"></script>
  <script>
    /* 深拷贝：创建一个新的对象/数组，将原对象的各项属性的“值”（数组的所有元素）拷贝过来，是“值”而不是“引用” */



    /* 浅拷贝就是将一个变量直接复制给另一个变量，不管它是基本数据类型，还是对象或数组。
       深拷贝遇到对象或者数组，会创建一个新的对象(会新开辟一块内存空间)，把原对象中的属性一个一个复制到新对象中去，并且
       如果这个属性也是对象的话，依旧采用深拷贝的方式这样进行递归复制
        
       又，引用数据类型的变量存放的是地址，所以在复制的时候就是把一个变量的地址给另一个变量，两个变量指向同一片内存空间(两个
       变量实际上引用同一个对象)。
       所以浅拷贝两个变量指向同一片内存空间，深拷贝两个变量指向不同的内存空间。 */




      const target = {
          field1: 1,
          field2: undefined,
          field3: {
              child: 'child'
          },
          field4: [2, 4, 8]
      };
      target.target = target; // 循环引用，即对象的属性间接或直接的引用了自身的情况

      function clone(target, map = new Map()) {
          if(typeof target === 'object') {
              let cloneTarget = target instanceof Array ? [] : {}
              if(map.get(target))
                  return map.get(target)
              map.set(target, cloneTarget)
              for(let key in target) {
                  cloneTarget[key] = clone(target[key], map)
              }
              return cloneTarget
          } else {
              return target
          }
      }
      
      console.log(clone(target))

  </script>
</head>

<body>


</body>

</html>